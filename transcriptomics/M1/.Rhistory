# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
DimPlot(obj.combined.sct, reduction = "umap", group.by = "subclass", split.by = "dataset", label = TRUE, raster = FALSE) + NoLegend() + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
cells.opossum <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Opossum_M1",])
Idents(obj.opossum) <- "RNA_snn_res.1"
cells.l23it <- WhichCells(obj.opossum, ident = c("1", "3", "6", "12"))
cells.opossum.l23it <- Reduce(intersect,list(cells.opossum, cells.l23it))
obj.combined.sct$subclass[cells.opossum.l23it] <- "L2/3 IT"
cells.l5it <- WhichCells(obj.opossum, ident = c("5", "7", "8", "11", "13"))
cells.opossum.l5it <- Reduce(intersect,list(cells.opossum, cells.l5it))
obj.combined.sct$subclass[cells.opossum.l5it] <- "L5 IT"
# cells.l6it <- WhichCells(obj.opossum, ident = c(""))
# cells.opossum.l6it <- Reduce(intersect,list(cells.opossum, cells.l6it))
# obj.combined.sct$subclass[cells.opossum.l6it] <- "L6 IT"
cells.l5et <- WhichCells(obj.opossum, ident = c("9"))
cells.opossum.l5et <- Reduce(intersect,list(cells.opossum, cells.l5et))
obj.combined.sct$subclass[cells.opossum.l5et] <- "L5 ET"
cells.l56np <- WhichCells(obj.opossum, ident = c("14"))
cells.opossum.l56np <- Reduce(intersect,list(cells.opossum, cells.l56np))
obj.combined.sct$subclass[cells.opossum.l56np] <- "L5/6 NP"
cells.l6b <- WhichCells(obj.opossum, ident = c("15"))
cells.opossum.l6b <- Reduce(intersect,list(cells.opossum, cells.l6b))
obj.combined.sct$subclass[cells.opossum.l6b] <- "L6b"
cells.l6ct <- WhichCells(obj.opossum, ident = c("2", "4", "10"))
cells.opossum.l6ct <- Reduce(intersect,list(cells.opossum, cells.l6ct))
obj.combined.sct$subclass[cells.opossum.l6ct] <- "L6 CT"
# Idents(obj.combined.sct) <- "subclass"
# obj.combined.sct <- subset(obj.combined.sct, subset = subclass != "L6 IT Car3")
cells.label <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Mouse_M1",])
obj.combined.sct[["subclass"]][cells.label,] <- obj.combined.sct[["subclass_label"]][cells.label,]
# dataset_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset", raster = FALSE) + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
DimPlot(obj.combined.sct, reduction = "umap", group.by = "subclass", split.by = "dataset", label = TRUE, raster = FALSE) + NoLegend() + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
DimPlot(obj.opossum, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
obj.combined.sct[["op_RNA_snn_res.1.5"]][colnames(obj.opossum),] <- obj.opossum[["RNA_snn_res.1.5"]]
obj.combined.sct[["op_RNA_snn_res.1.5"]] <- NA
obj.combined.sct[["op_RNA_snn_res.1.5"]][colnames(obj.opossum),] <- obj.opossum[["RNA_snn_res.1.5"]]
DimPlot(obj.opossum, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
DimPlot(obj.combined.sct, reduction = "umap", group.by = "op_RNA_snn_res.1.5", split.by = "dataset", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
DimPlot(obj.opossum, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
DimPlot(obj.combined.sct, reduction = "umap", group.by = "op_RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
cells.opossum <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Opossum_M1",])
Idents(obj.opossum) <- "RNA_snn_res.1.5"
cells.l23it <- WhichCells(obj.opossum, ident = c("3", "4", "7", "12", "14", "18", "22"))
cells.opossum.l23it <- Reduce(intersect,list(cells.opossum, cells.l23it))
obj.combined.sct$subclass[cells.opossum.l23it] <- "L2/3 IT"
cells.l5it <- WhichCells(obj.opossum, ident = c("2", "5", "6", "8", "13", "15", "20", "23"))
cells.opossum.l5it <- Reduce(intersect,list(cells.opossum, cells.l5it))
obj.combined.sct$subclass[cells.opossum.l5it] <- "L5 IT"
# cells.l6it <- WhichCells(obj.opossum, ident = c(""))
# cells.opossum.l6it <- Reduce(intersect,list(cells.opossum, cells.l6it))
# obj.combined.sct$subclass[cells.opossum.l6it] <- "L6 IT"
cells.l5et <- WhichCells(obj.opossum, ident = c("21"))
cells.opossum.l5et <- Reduce(intersect,list(cells.opossum, cells.l5et))
obj.combined.sct$subclass[cells.opossum.l5et] <- "L5 ET"
cells.l56np <- WhichCells(obj.opossum, ident = c("9", "16"))
cells.opossum.l56np <- Reduce(intersect,list(cells.opossum, cells.l56np))
obj.combined.sct$subclass[cells.opossum.l56np] <- "L5/6 NP"
cells.l6b <- WhichCells(obj.opossum, ident = c("11"))
cells.opossum.l6b <- Reduce(intersect,list(cells.opossum, cells.l6b))
obj.combined.sct$subclass[cells.opossum.l6b] <- "L6b"
cells.l6ct <- WhichCells(obj.opossum, ident = c("1", "10", "17", "19"))
cells.opossum.l6ct <- Reduce(intersect,list(cells.opossum, cells.l6ct))
obj.combined.sct$subclass[cells.opossum.l6ct] <- "L6 CT"
# Idents(obj.combined.sct) <- "subclass"
# obj.combined.sct <- subset(obj.combined.sct, subset = subclass != "L6 IT Car3")
cells.label <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Mouse_M1",])
obj.combined.sct[["subclass"]][cells.label,] <- obj.combined.sct[["subclass_label"]][cells.label,]
# dataset_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset", raster = FALSE) + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
DimPlot(obj.combined.sct, reduction = "umap", group.by = "subclass", split.by = "dataset", label = TRUE, raster = FALSE) + NoLegend() + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
Idents(obj.opossum) <- "RNA_snn_res.1.5"
obj.combined.sct[["op_RNA_snn_res.1.5"]][colnames(obj.opossum),] <- obj.opossum[["RNA_snn_res.1.5"]]
DimPlot(obj.opossum, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
DimPlot(obj.combined.sct, reduction = "umap", group.by = "op_RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
colnames(obj.opossum)
cells.opossum <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Opossum_M1",])
Idents(obj.opossum) <- "RNA_snn_res.1.5"
cells.l23it <- WhichCells(obj.opossum, ident = c("3", "4", "7", "12", "14", "18", "22"))
cells.opossum.l23it <- Reduce(intersect,list(cells.opossum, cells.l23it))
obj.combined.sct$subclass[cells.opossum.l23it] <- "L2/3 IT"
cells.l5it <- WhichCells(obj.opossum, ident = c("2", "5", "6", "8", "13", "15", "20", "23"))
cells.opossum.l5it <- Reduce(intersect,list(cells.opossum, cells.l5it))
obj.combined.sct$subclass[cells.opossum.l5it] <- "L5 IT"
# cells.l6it <- WhichCells(obj.opossum, ident = c(""))
# cells.opossum.l6it <- Reduce(intersect,list(cells.opossum, cells.l6it))
# obj.combined.sct$subclass[cells.opossum.l6it] <- "L6 IT"
cells.l5et <- WhichCells(obj.opossum, ident = c("21"))
cells.opossum.l5et <- Reduce(intersect,list(cells.opossum, cells.l5et))
obj.combined.sct$subclass[cells.opossum.l5et] <- "L5 ET"
cells.l56np <- WhichCells(obj.opossum, ident = c("9", "16"))
cells.opossum.l56np <- Reduce(intersect,list(cells.opossum, cells.l56np))
obj.combined.sct$subclass[cells.opossum.l56np] <- "L5/6 NP"
cells.l6b <- WhichCells(obj.opossum, ident = c("11"))
cells.opossum.l6b <- Reduce(intersect,list(cells.opossum, cells.l6b))
obj.combined.sct$subclass[cells.opossum.l6b] <- "L6b"
cells.l6ct <- WhichCells(obj.opossum, ident = c("1", "5", "3", "18"))
cells.opossum.l6ct <- Reduce(intersect,list(cells.opossum, cells.l6ct))
obj.combined.sct$subclass[cells.opossum.l6ct] <- "L6 CT"
# Idents(obj.combined.sct) <- "subclass"
# obj.combined.sct <- subset(obj.combined.sct, subset = subclass != "L6 IT Car3")
cells.label <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Mouse_M1",])
obj.combined.sct[["subclass"]][cells.label,] <- obj.combined.sct[["subclass_label"]][cells.label,]
# dataset_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset", raster = FALSE) + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
DimPlot(obj.combined.sct, reduction = "umap", group.by = "subclass", split.by = "dataset", label = TRUE, raster = FALSE) + NoLegend() + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
cells.opossum <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Opossum_M1",])
Idents(obj.opossum) <- "RNA_snn_res.1.5"
cells.l23it <- WhichCells(obj.opossum, ident = c("2", "4", "8", "15", "21"))
cells.opossum.l23it <- Reduce(intersect,list(cells.opossum, cells.l23it))
obj.combined.sct$subclass[cells.opossum.l23it] <- "L2/3 IT"
cells.l5it <- WhichCells(obj.opossum, ident = c("6", "9", "10", "11", "12", "13", "14", "16", "20", "22"))
cells.opossum.l5it <- Reduce(intersect,list(cells.opossum, cells.l5it))
obj.combined.sct$subclass[cells.opossum.l5it] <- "L5 IT"
# cells.l6it <- WhichCells(obj.opossum, ident = c(""))
# cells.opossum.l6it <- Reduce(intersect,list(cells.opossum, cells.l6it))
# obj.combined.sct$subclass[cells.opossum.l6it] <- "L6 IT"
cells.l5et <- WhichCells(obj.opossum, ident = c("7"))
cells.opossum.l5et <- Reduce(intersect,list(cells.opossum, cells.l5et))
obj.combined.sct$subclass[cells.opossum.l5et] <- "L5 ET"
cells.l56np <- WhichCells(obj.opossum, ident = c("17", "23"))
cells.opossum.l56np <- Reduce(intersect,list(cells.opossum, cells.l56np))
obj.combined.sct$subclass[cells.opossum.l56np] <- "L5/6 NP"
cells.l6b <- WhichCells(obj.opossum, ident = c("19"))
cells.opossum.l6b <- Reduce(intersect,list(cells.opossum, cells.l6b))
obj.combined.sct$subclass[cells.opossum.l6b] <- "L6b"
cells.l6ct <- WhichCells(obj.opossum, ident = c("1", "5", "3", "18"))
cells.opossum.l6ct <- Reduce(intersect,list(cells.opossum, cells.l6ct))
obj.combined.sct$subclass[cells.opossum.l6ct] <- "L6 CT"
# Idents(obj.combined.sct) <- "subclass"
# obj.combined.sct <- subset(obj.combined.sct, subset = subclass != "L6 IT Car3")
cells.label <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Mouse_M1",])
obj.combined.sct[["subclass"]][cells.label,] <- obj.combined.sct[["subclass_label"]][cells.label,]
# dataset_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset", raster = FALSE) + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
DimPlot(obj.combined.sct, reduction = "umap", group.by = "subclass", split.by = "dataset", label = TRUE, raster = FALSE) + NoLegend() + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
cells.opossum <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Opossum_M1",])
Idents(obj.opossum) <- "RNA_snn_res.1.5"
cells.l23it <- WhichCells(obj.opossum, ident = c("2", "4", "8", "12", "15", "21"))
cells.opossum.l23it <- Reduce(intersect,list(cells.opossum, cells.l23it))
obj.combined.sct$subclass[cells.opossum.l23it] <- "L2/3 IT"
cells.l5it <- WhichCells(obj.opossum, ident = c("6", "9", "10", "11", "13", "14", "16", "20", "22"))
cells.opossum.l5it <- Reduce(intersect,list(cells.opossum, cells.l5it))
obj.combined.sct$subclass[cells.opossum.l5it] <- "L5 IT"
# cells.l6it <- WhichCells(obj.opossum, ident = c(""))
# cells.opossum.l6it <- Reduce(intersect,list(cells.opossum, cells.l6it))
# obj.combined.sct$subclass[cells.opossum.l6it] <- "L6 IT"
cells.l5et <- WhichCells(obj.opossum, ident = c("7"))
cells.opossum.l5et <- Reduce(intersect,list(cells.opossum, cells.l5et))
obj.combined.sct$subclass[cells.opossum.l5et] <- "L5 ET"
cells.l56np <- WhichCells(obj.opossum, ident = c("17", "23"))
cells.opossum.l56np <- Reduce(intersect,list(cells.opossum, cells.l56np))
obj.combined.sct$subclass[cells.opossum.l56np] <- "L5/6 NP"
cells.l6b <- WhichCells(obj.opossum, ident = c("19"))
cells.opossum.l6b <- Reduce(intersect,list(cells.opossum, cells.l6b))
obj.combined.sct$subclass[cells.opossum.l6b] <- "L6b"
cells.l6ct <- WhichCells(obj.opossum, ident = c("1", "5", "3", "18"))
cells.opossum.l6ct <- Reduce(intersect,list(cells.opossum, cells.l6ct))
obj.combined.sct$subclass[cells.opossum.l6ct] <- "L6 CT"
# Idents(obj.combined.sct) <- "subclass"
# obj.combined.sct <- subset(obj.combined.sct, subset = subclass != "L6 IT Car3")
cells.label <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Mouse_M1",])
obj.combined.sct[["subclass"]][cells.label,] <- obj.combined.sct[["subclass_label"]][cells.label,]
# dataset_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset", raster = FALSE) + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
DimPlot(obj.combined.sct, reduction = "umap", group.by = "subclass", split.by = "dataset", label = TRUE, raster = FALSE) + NoLegend() + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
cells.opossum <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Opossum_M1",])
Idents(obj.opossum) <- "RNA_snn_res.1.5"
cells.l23it <- WhichCells(obj.opossum, ident = c("2", "4", "8", "12", "21"))
cells.opossum.l23it <- Reduce(intersect,list(cells.opossum, cells.l23it))
obj.combined.sct$subclass[cells.opossum.l23it] <- "L2/3 IT"
cells.l5it <- WhichCells(obj.opossum, ident = c("6", "9", "10", "11", "13", "14", "15", "16", "20", "22"))
cells.opossum.l5it <- Reduce(intersect,list(cells.opossum, cells.l5it))
obj.combined.sct$subclass[cells.opossum.l5it] <- "L5 IT"
# cells.l6it <- WhichCells(obj.opossum, ident = c(""))
# cells.opossum.l6it <- Reduce(intersect,list(cells.opossum, cells.l6it))
# obj.combined.sct$subclass[cells.opossum.l6it] <- "L6 IT"
cells.l5et <- WhichCells(obj.opossum, ident = c("7"))
cells.opossum.l5et <- Reduce(intersect,list(cells.opossum, cells.l5et))
obj.combined.sct$subclass[cells.opossum.l5et] <- "L5 ET"
cells.l56np <- WhichCells(obj.opossum, ident = c("17", "23"))
cells.opossum.l56np <- Reduce(intersect,list(cells.opossum, cells.l56np))
obj.combined.sct$subclass[cells.opossum.l56np] <- "L5/6 NP"
cells.l6b <- WhichCells(obj.opossum, ident = c("19"))
cells.opossum.l6b <- Reduce(intersect,list(cells.opossum, cells.l6b))
obj.combined.sct$subclass[cells.opossum.l6b] <- "L6b"
cells.l6ct <- WhichCells(obj.opossum, ident = c("1", "5", "3", "18"))
cells.opossum.l6ct <- Reduce(intersect,list(cells.opossum, cells.l6ct))
obj.combined.sct$subclass[cells.opossum.l6ct] <- "L6 CT"
# Idents(obj.combined.sct) <- "subclass"
# obj.combined.sct <- subset(obj.combined.sct, subset = subclass != "L6 IT Car3")
cells.label <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Mouse_M1",])
obj.combined.sct[["subclass"]][cells.label,] <- obj.combined.sct[["subclass_label"]][cells.label,]
# dataset_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset", raster = FALSE) + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
DimPlot(obj.combined.sct, reduction = "umap", group.by = "subclass", split.by = "dataset", label = TRUE, raster = FALSE) + NoLegend() + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
cells.opossum <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Opossum_M1",])
Idents(obj.opossum) <- "RNA_snn_res.1.5"
cells.l23it <- WhichCells(obj.opossum, ident = c("2", "4", "8", "12", "15"))
cells.opossum.l23it <- Reduce(intersect,list(cells.opossum, cells.l23it))
obj.combined.sct$subclass[cells.opossum.l23it] <- "L2/3 IT"
cells.l5it <- WhichCells(obj.opossum, ident = c("6", "9", "10", "11", "13", "14", "16", "20", "21", "22"))
cells.opossum.l5it <- Reduce(intersect,list(cells.opossum, cells.l5it))
obj.combined.sct$subclass[cells.opossum.l5it] <- "L5 IT"
# cells.l6it <- WhichCells(obj.opossum, ident = c(""))
# cells.opossum.l6it <- Reduce(intersect,list(cells.opossum, cells.l6it))
# obj.combined.sct$subclass[cells.opossum.l6it] <- "L6 IT"
cells.l5et <- WhichCells(obj.opossum, ident = c("7"))
cells.opossum.l5et <- Reduce(intersect,list(cells.opossum, cells.l5et))
obj.combined.sct$subclass[cells.opossum.l5et] <- "L5 ET"
cells.l56np <- WhichCells(obj.opossum, ident = c("17", "23"))
cells.opossum.l56np <- Reduce(intersect,list(cells.opossum, cells.l56np))
obj.combined.sct$subclass[cells.opossum.l56np] <- "L5/6 NP"
cells.l6b <- WhichCells(obj.opossum, ident = c("19"))
cells.opossum.l6b <- Reduce(intersect,list(cells.opossum, cells.l6b))
obj.combined.sct$subclass[cells.opossum.l6b] <- "L6b"
cells.l6ct <- WhichCells(obj.opossum, ident = c("1", "5", "3", "18"))
cells.opossum.l6ct <- Reduce(intersect,list(cells.opossum, cells.l6ct))
obj.combined.sct$subclass[cells.opossum.l6ct] <- "L6 CT"
# Idents(obj.combined.sct) <- "subclass"
# obj.combined.sct <- subset(obj.combined.sct, subset = subclass != "L6 IT Car3")
cells.label <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Mouse_M1",])
obj.combined.sct[["subclass"]][cells.label,] <- obj.combined.sct[["subclass_label"]][cells.label,]
# dataset_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset", raster = FALSE) + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
DimPlot(obj.combined.sct, reduction = "umap", group.by = "subclass", split.by = "dataset", label = TRUE, raster = FALSE) + NoLegend() + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
cells.opossum <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Opossum_M1",])
Idents(obj.opossum) <- "RNA_snn_res.1.5"
cells.l23it <- WhichCells(obj.opossum, ident = c("2", "4", "8", "12", "15", "21"))
cells.opossum.l23it <- Reduce(intersect,list(cells.opossum, cells.l23it))
obj.combined.sct$subclass[cells.opossum.l23it] <- "L2/3 IT"
cells.l5it <- WhichCells(obj.opossum, ident = c("6", "9", "10", "11", "13", "14", "16", "20", "22"))
cells.opossum.l5it <- Reduce(intersect,list(cells.opossum, cells.l5it))
obj.combined.sct$subclass[cells.opossum.l5it] <- "L5 IT"
# cells.l6it <- WhichCells(obj.opossum, ident = c(""))
# cells.opossum.l6it <- Reduce(intersect,list(cells.opossum, cells.l6it))
# obj.combined.sct$subclass[cells.opossum.l6it] <- "L6 IT"
cells.l5et <- WhichCells(obj.opossum, ident = c("7"))
cells.opossum.l5et <- Reduce(intersect,list(cells.opossum, cells.l5et))
obj.combined.sct$subclass[cells.opossum.l5et] <- "L5 ET"
cells.l56np <- WhichCells(obj.opossum, ident = c("17", "23"))
cells.opossum.l56np <- Reduce(intersect,list(cells.opossum, cells.l56np))
obj.combined.sct$subclass[cells.opossum.l56np] <- "L5/6 NP"
cells.l6b <- WhichCells(obj.opossum, ident = c("19"))
cells.opossum.l6b <- Reduce(intersect,list(cells.opossum, cells.l6b))
obj.combined.sct$subclass[cells.opossum.l6b] <- "L6b"
cells.l6ct <- WhichCells(obj.opossum, ident = c("1", "5", "3", "18"))
cells.opossum.l6ct <- Reduce(intersect,list(cells.opossum, cells.l6ct))
obj.combined.sct$subclass[cells.opossum.l6ct] <- "L6 CT"
# Idents(obj.combined.sct) <- "subclass"
# obj.combined.sct <- subset(obj.combined.sct, subset = subclass != "L6 IT Car3")
cells.label <- rownames(obj.combined.sct[[]][obj.combined.sct[["dataset"]] == "Mouse_M1",])
obj.combined.sct[["subclass"]][cells.label,] <- obj.combined.sct[["subclass_label"]][cells.label,]
# dataset_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset", raster = FALSE) + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
DimPlot(obj.combined.sct, reduction = "umap", group.by = "subclass", split.by = "dataset", label = TRUE, raster = FALSE) + NoLegend() + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
dataset_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset", raster = FALSE) + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
subclass_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "subclass", split.by = "dataset", label = TRUE, raster = FALSE) + NoLegend() + xlim(-16, 14) + ylim(-18, 12) + coord_equal()
ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
DimPlot(obj.mouse, reduction = "umap", group.by = "subclass_label", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
obj.mouse
library(Seurat)
library(reticulate)
library(arrow)
library(ggplot2)
library(dplyr)
library(SeuratDisk)
obj.opossum.glutamatergic <- LoadH5Seurat("E:/Opossum_M1/seurat/opossum_m1_glutamatergic.h5Seurat")
DimPlot(obj.opossum.glutamatergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
obj.combined.sct[[]]
obj.opossum.glutamatergic[["subclass"]] <- NA
obj.opossum.glutamatergic[["subclass"]] <- obj.combined.sct[["subclass"]][colnames(obj.opossum.glutamatergic),]
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "subclass", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "subclass", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
g <- ggplot_build(subclass_plot)
unique(g$data[[1]]["colour"])
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "subclass", cols = c("#F8766D", "#53B400", "#C49A00", "#00B6EB", "#00C094", "#FB61D7"), label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "subclass", cols = c("#F8766D", "#C49A00", "#53B400", "#00B6EB", "#00C094", "#FB61D7"), label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "subclass", cols = c("#F8766D", "#C49A00", "#53B400", "#00C094", "#00B6EB", "#FB61D7"), label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
# DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
# DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
# DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
subclass_plot <- DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "subclass", cols = c("#F8766D", "#C49A00", "#53B400", "#00C094", "#00B6EB", "#FB61D7"), label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=4, height=4)
# DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
# DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
# DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
subclass_plot <- DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "subclass", cols = c("#F8766D", "#C49A00", "#53B400", "#00C094", "#00B6EB", "#FB61D7"), label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=4, height=4)
library(Seurat)
library(reticulate)
library(arrow)
library(ggplot2)
library(dplyr)
library(SeuratDisk)
obj.mouse.glutamatergic <- LoadH5Seurat("E:/Mouse_M1/seurat/mouse_m1_glutamatergic.h5Seurat")
library(Seurat)
library(reticulate)
library(arrow)
library(ggplot2)
library(dplyr)
library(SeuratDisk)
obj.mouse.glutamatergic <- LoadH5Seurat("E:/Mouse_M1/seurat/mouse_m1_glutamatergic.h5Seurat")
DimPlot(obj.mouse.glutamatergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", group.by = "subclass_label", label = TRUE, label.size = 4, raster = FALSE) + NoLegend()  + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", group.by = "cluster_label", label = TRUE, label.size = 2,raster = FALSE) + NoLegend()  + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
obj.mouse.glutamatergic <- FindVariableFeatures(obj.mouse.glutamatergic, selection.method = "vst", nfeatures = 3000)
all.genes <- rownames(obj.mouse.glutamatergic)
obj.mouse.glutamatergic <- ScaleData(obj.mouse.glutamatergic, features = all.genes)
obj.mouse.glutamatergic <- RunPCA(obj.mouse.glutamatergic, features = VariableFeatures(object = obj.mouse.glutamatergic))
ElbowPlot(obj.mouse.glutamatergic, ndims = 50)
obj.mouse.glutamatergic <- FindNeighbors(obj.mouse.glutamatergic, dims = 1:30)
obj.mouse.glutamatergic <- FindClusters(obj.mouse.glutamatergic, resolution = 1, algorithm = 4, method = "igraph")
obj.mouse.glutamatergic <- RunUMAP(obj.mouse.glutamatergic, dims = 1:30, method="umap-learn")
DimPlot(obj.mouse.glutamatergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", group.by = "subclass_label", label = TRUE, label.size = 4, raster = FALSE) + NoLegend()  + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", group.by = "cluster_label", label = TRUE, label.size = 2,raster = FALSE) + NoLegend()  + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
Idents(obj.mouse.glutamatergic) <- "subclass"
obj.mouse.glutamatergic <- subset(obj.mouse.glutamatergic, subset = subclass != "L6 IT Car3")
Idents(obj.mouse.glutamatergic) <- "subclass"
obj.mouse.glutamatergic <- subset(obj.mouse.glutamatergic, subset = subclass_label != "L6 IT Car3")
DimPlot(obj.mouse.glutamatergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", group.by = "subclass_label", label = TRUE, label.size = 4, raster = FALSE) + NoLegend()  + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", group.by = "cluster_label", label = TRUE, label.size = 2,raster = FALSE) + NoLegend()  + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", group.by = "subclass_label", label = TRUE, label.size = 4, raster = FALSE) + NoLegend()  + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", group.by = "cluster_label", label = TRUE, label.size = 2,raster = FALSE) + NoLegend()  + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", group.by = "subclass_label", label = TRUE, label.size = 4, raster = FALSE) + NoLegend()  + xlim(-17, 13) + ylim(-18, 12) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", group.by = "cluster_label", label = TRUE, label.size = 2,raster = FALSE) + NoLegend()  + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.mouse.glutamatergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
subclass_plot <- DimPlot(obj.mouse.glutamatergic, reduction = "umap", group.by = "subclass_label", label = TRUE, label.size = 4, raster = FALSE) + NoLegend()  + xlim(-17, 13) + ylim(-18, 12) + coord_equal()
ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=4, height=4)
DimPlot(obj.mouse.glutamatergic, reduction = "umap", group.by = "cluster_label", label = TRUE, label.size = 2,raster = FALSE) + NoLegend()  + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
library(Seurat)
library(reticulate)
library(scrubletR)
library(ggplot2)
library(cowplot)
library(dplyr)
library(SeuratDisk)
obj.mouse <- LoadH5Seurat("E:/mouse_v1_gabaergic.h5seurat")
obj.mouse[["dataset"]] <- "Mouse_V1"
obj.opossum <- LoadH5Seurat("E:/Opossum_M1/seurat/opossum_m1_gabaergic.h5seurat")
obj.opossum[["dataset"]] <- "Opossum_M1"
obj.opossum <- obj.opossum[, sample(colnames(obj.opossum), size = ncol(obj.mouse), replace = FALSE)]
common.features <- intersect(rownames(obj.mouse), rownames(obj.opossum))
obj.combined <- merge(obj.mouse[common.features,], y = obj.opossum[common.features,])
obj.list <- SplitObject(obj.combined, split.by = "dataset")
VlnPlot(obj.combined, features = c("nCount_RNA"), group.by = "dataset")
obj.list[["Mouse_M1"]] <- SCTransform(obj.list[["Mouse_M1"]], vst.flavor = "v2", verbose = FALSE) %>%
RunPCA(npcs = 30, verbose = FALSE) %>%
RunUMAP(reduction = "pca", dims = 1:30, verbose = FALSE) %>%
FindNeighbors(reduction = "pca", dims = 1:30, verbose = FALSE) %>%
FindClusters(resolution = 1, algorithm = 4, method = "igraph")
obj.list[["Mouse_V1"]] <- SCTransform(obj.list[["Mouse_V1"]], vst.flavor = "v2", verbose = FALSE) %>%
RunPCA(npcs = 30, verbose = FALSE) %>%
RunUMAP(reduction = "pca", dims = 1:30, verbose = FALSE) %>%
FindNeighbors(reduction = "pca", dims = 1:30, verbose = FALSE) %>%
FindClusters(resolution = 1, algorithm = 4, method = "igraph")
DimPlot(obj.list[["Mouse_V1"]], label = TRUE, repel = TRUE) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
obj.list[["Opossum_M1"]] <- SCTransform(obj.list[["Opossum_M1"]], vst.flavor = "v2", verbose = FALSE) %>%
RunPCA(npcs = 30, verbose = FALSE) %>%
RunUMAP(reduction = "pca", dims = 1:30, verbose = FALSE) %>%
FindNeighbors(reduction = "pca", dims = 1:30, verbose = FALSE) %>%
FindClusters(resolution = 1, algorithm = 4, method = "igraph")
DimPlot(obj.list[["Opossum_M1"]], label = TRUE, repel = TRUE) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
features <- SelectIntegrationFeatures(object.list = obj.list, nfeatures = 3000)
obj.list <- PrepSCTIntegration(object.list = obj.list, anchor.features = features)
anchors <- FindIntegrationAnchors(object.list = obj.list, normalization.method = "SCT", anchor.features = features)
obj.combined.sct <- IntegrateData(anchorset = anchors, normalization.method = "SCT")
obj.combined.sct <- RunPCA(obj.combined.sct, verbose = FALSE)
obj.combined.sct <- RunUMAP(obj.combined.sct, reduction = "pca", dims = 1:30, verbose = FALSE)
obj.combined.sct <- FindNeighbors(obj.combined.sct, reduction = "pca", dims = 1:30)
obj.combined.sct <- FindClusters(obj.combined.sct, resolution = 1, algorithm = 4, method = "igraph")
# DimPlot(obj.combined.sct, reduction = "umap", group.by = "integrated_snn_res.1", label = TRUE) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset") + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# dataset_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset") + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_GABAergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
# DimPlot(obj.combined.sct, reduction = "umap", group.by = "cluster_label", label = TRUE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# DimPlot(obj.combined.sct, reduction = "umap", split.by = "dataset", group.by = "RNA_snn_res.1.5", label = TRUE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# DimPlot(obj.combined.sct, reduction = "umap", split.by = "dataset", group.by = "subclass", label = TRUE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# subclass_plot <- DimPlot(obj.combined.sct, reduction = "umap", split.by = "dataset", group.by = "subclass", label = TRUE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_GABAergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
# FeaturePlot(obj.combined.sct, reduction = "umap", features = c("Sst"), slot = "scale.data", min.cutoff = 0) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# FeaturePlot(obj.combined.sct, reduction = "umap", features = c("Myo5b"), slot = "scale.data", min.cutoff = 0) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# FeaturePlot(obj.combined.sct, reduction = "umap", features = c("Vip"), slot = "scale.data", min.cutoff = 0) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# FeaturePlot(obj.combined.sct, reduction = "umap", features = c("Lamp5"), slot = "scale.data", min.cutoff = 0) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# FeaturePlot(obj.combined.sct, reduction = "umap", features = c("Sncg")) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# FeaturePlot(obj.combined.sct, reduction = "umap", features = c("Meis2"), slot = "scale.data", min.cutoff = 0) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
DimPlot(obj.combined.sct, reduction = "umap", group.by = "integrated_snn_res.1", label = TRUE) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset") + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# dataset_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset") + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_GABAergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
# DimPlot(obj.combined.sct, reduction = "umap", group.by = "cluster_label", label = TRUE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# DimPlot(obj.combined.sct, reduction = "umap", split.by = "dataset", group.by = "RNA_snn_res.1.5", label = TRUE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# DimPlot(obj.combined.sct, reduction = "umap", split.by = "dataset", group.by = "subclass", label = TRUE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# subclass_plot <- DimPlot(obj.combined.sct, reduction = "umap", split.by = "dataset", group.by = "subclass", label = TRUE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_GABAergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
DimPlot(obj.combined.sct, reduction = "umap", group.by = "integrated_snn_res.1", label = TRUE) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset") + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# dataset_plot <- DimPlot(obj.combined.sct, reduction = "umap", group.by = "dataset") + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_GABAergic_Dataset.svg", plot=dataset_plot, width=6, height=4)
# DimPlot(obj.combined.sct, reduction = "umap", group.by = "cluster_label", label = TRUE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# DimPlot(obj.combined.sct, reduction = "umap", split.by = "dataset", group.by = "RNA_snn_res.1.5", label = TRUE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# DimPlot(obj.combined.sct, reduction = "umap", split.by = "dataset", group.by = "subclass", label = TRUE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# subclass_plot <- DimPlot(obj.combined.sct, reduction = "umap", split.by = "dataset", group.by = "subclass", label = TRUE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Mouse_Opossum_M1_GABAergic_Subclass.svg", plot=subclass_plot, width=8.5, height=4.5)
FeaturePlot(obj.combined.sct, reduction = "umap", features = c("Sst"), slot = "scale.data", min.cutoff = 0) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
FeaturePlot(obj.combined.sct, reduction = "umap", features = c("Myo5b"), slot = "scale.data", min.cutoff = 0) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
FeaturePlot(obj.combined.sct, reduction = "umap", features = c("Vip"), slot = "scale.data", min.cutoff = 0) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
FeaturePlot(obj.combined.sct, reduction = "umap", features = c("Lamp5"), slot = "scale.data", min.cutoff = 0) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
FeaturePlot(obj.combined.sct, reduction = "umap", features = c("Sncg")) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
Idents(obj.combined.sct) <- "integrated_snn_res.1"
obj.combined.sct.vip <- subset(obj.combined.sct, idents = "3")
obj.combined.sct.vip <- PrepSCTFindMarkers(obj.combined.sct.vip)
Idents(obj.combined.sct.vip) <- "dataset"
vip.markers <- FindMarkers(obj.combined.sct.vip, assay = "SCT", ident.1 = "Opossum_M1", ident.2 = "Mouse_V1", verbose = FALSE)
View(vip.markers)
View(vip.markers)
library(Seurat)
library(reticulate)
library(arrow)
library(ggplot2)
library(dplyr)
library(SeuratDisk)
obj.opossum.glutamatergic <- LoadH5Seurat("E:/Opossum_M1/seurat/opossum_m1_glutamatergic.h5Seurat")
obj.opossum.gabaergic <- LoadH5Seurat("E:/Opossum_M1/seurat/opossum_m1_gabaergic.h5Seurat")
obj.opossum.nonneuronal <- LoadH5Seurat("E:/Opossum_M1/seurat/opossum_m1_nonneuronal.h5Seurat")
obj.opossum.glutamatergic[[]]
obj.opossum.gabaergic[[]]
obj.opossum.nonneuronal[[]]
obj.opossum <- merge(obj.opossum.glutamatergic, y = c(obj.opossum.gabaergic, obj.opossum.nonneuronal))
obj.opossum[[]]
rm(obj.opossum.glutamatergic)
rm(obj.opossum.gabaergic)
rm(obj.opossum.nonneuronal)
obj.opossum <- FindVariableFeatures(obj.opossum, selection.method = "vst", nfeatures = 3000)
all.genes <- rownames(obj.opossum)
obj.opossum <- ScaleData(obj.opossum, features = all.genes)
obj.opossum <- RunPCA(obj.opossum, features = VariableFeatures(object = obj.opossum))
ElbowPlot(obj.opossum, ndims = 50)
obj.opossum <- FindNeighbors(obj.opossum, dims = 1:30)
obj.opossum <- FindClusters(obj.opossum, resolution = 1, algorithm = 4, method = "igraph")
obj.opossum <- RunUMAP(obj.opossum, dims = 1:30, method="umap-learn")
DimPlot(obj.opossum, reduction = "umap", group.by = "subclass", label = TRUE, raster = FALSE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
library(Seurat)
library(reticulate)
library(arrow)
library(ggplot2)
library(dplyr)
library(SeuratDisk)
obj.opossum.glutamatergic <- LoadH5Seurat("E:/Opossum_M1/seurat/opossum_m1_glutamatergic.h5Seurat")
Idents(obj.opossum.glutamatergic) <- "RNA_snn_res.1.5"
cells.l23it <- WhichCells(obj.opossum.glutamatergic, ident = c("2", "4", "8", "12", "15", "21"))
obj.opossum.glutamatergic$subclass <- ifelse(colnames(obj.opossum.glutamatergic) %in% cells.l23it, "L2/3 IT", "ambiguous")
cells.l5it <- WhichCells(obj.opossum.glutamatergic, ident = c("6", "9", "10", "11", "13", "14", "16", "20", "22"))
obj.opossum.glutamatergic$subclass[cells.l5it] <- "L5 IT"
# cells.l6it <- WhichCells(obj.opossum.glutamatergic, ident = c("9"))
# obj.opossum.glutamatergic$subclass[cells.l6it] <- "L6 IT"
cells.l5et <- WhichCells(obj.opossum.glutamatergic, ident = c("7"))
obj.opossum.glutamatergic$subclass[cells.l5et] <- "L5 ET"
cells.l56np <- WhichCells(obj.opossum.glutamatergic, ident = c("17", "23"))
obj.opossum.glutamatergic$subclass[cells.l56np] <- "L5/6 NP"
cells.l6b <- WhichCells(obj.opossum.glutamatergic, ident = c("19"))
obj.opossum.glutamatergic$subclass[cells.l6b] <- "L6b"
cells.l6ct <- WhichCells(obj.opossum.glutamatergic, ident = c("1", "5", "3", "18"))
obj.opossum.glutamatergic$subclass[cells.l6ct] <- "L6 CT"
Idents(obj.opossum.glutamatergic) <- "subclass"
obj.opossum.glutamatergic <- subset(obj.opossum.glutamatergic, subset = subclass != "ambiguous")
# DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "RNA_snn_res.1.5", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
# DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
# DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 15) + ylim(-18, 15) + coord_equal()
DimPlot(obj.opossum.glutamatergic, reduction = "umap", group.by = "subclass", cols = c("#F8766D", "#C49A00", "#53B400", "#00C094", "#00B6EB", "#FB61D7"), label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 12) + ylim(-18, 12) + coord_equal()
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/Opossum_M1_Glutamatergic_Subclass.svg", plot=subclass_plot, width=4, height=4)
SaveH5Seurat(obj.opossum.glutamatergic, "E:/Opossum_M1/seurat/opossum_m1_glutamatergic.h5seurat", overwrite = TRUE, verbose = TRUE)
library(Seurat)
library(reticulate)
library(arrow)
library(ggplot2)
library(dplyr)
library(SeuratDisk)
obj.opossum.glutamatergic <- LoadH5Seurat("E:/Opossum_M1/seurat/opossum_m1_glutamatergic.h5Seurat")
