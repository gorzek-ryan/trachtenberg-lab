DefaultAssay(obj.opossum.gabaergic.pvalb) <- "RNA"
Idents(obj.opossum.gabaergic.pvalb) <- "SCT_snn_res.1"
all.markers.pvalb <- FindAllMarkers(obj.opossum.gabaergic.pvalb, only.pos = TRUE)
all.markers.pvalb.2 <- subset(all.markers.pvalb, cluster == 2)
all.markers.pvalb.3 <- subset(all.markers.pvalb, cluster == 3)
all.markers.pvalb.6 <- subset(all.markers.pvalb, cluster == 6)
all.markers.pvalb.8 <- subset(all.markers.pvalb, cluster == 8)
all.markers.pvalb.9 <- subset(all.markers.pvalb, cluster == 9)
all.markers.pvalb.12 <- subset(all.markers.pvalb, cluster == 12)
all.markers.pvalb.14 <- subset(all.markers.pvalb, cluster == 14)
View(all.markers.pvalb.12)
View(all.markers.pvalb.14)
View(all.markers.pvalb.2)
View(all.markers.pvalb.3)
View(all.markers.pvalb.6)
View(all.markers.pvalb.8)
View(all.markers.pvalb.9)
Idents(obj.opossum.gabaergic) <- "subclass"
obj.opossum.gabaergic.vip <- subset(obj.opossum.gabaergic, idents = "Vip")
Idents(obj.opossum.gabaergic.vip) <- "SCT_snn_res.1"
DefaultAssay(obj.opossum.gabaergic.vip) <- "RNA"
all.markers.vip <- FindAllMarkers(obj.opossum.gabaergic.vip, only.pos = TRUE)
all.markers.vip.5 <- subset(all.markers.vip, cluster == 5)
all.markers.vip.11 <- subset(all.markers.vip, cluster == 11)
all.markers.vip.15 <- subset(all.markers.vip, cluster == 15)
View(all.markers.vip.5)
View(all.markers.vip.11)
View(all.markers.vip.15)
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "SCT_snn_res.2", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nFeature_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nCount_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
VlnPlot(obj.opossum.gabaergic, "nCount_RNA")
FeaturePlot(obj.opossum.gabaergic, "Plec", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
library(Seurat)
library(reticulate)
library(arrow)
library(ggplot2)
library(dplyr)
library(SeuratDisk)
obj.opossum.gabaergic <- LoadH5Seurat("E:/Opossum_M1/seurat/opossum_m1_gabaergic_raw.h5Seurat")
library(Seurat)
library(reticulate)
library(arrow)
library(ggplot2)
library(dplyr)
library(SeuratDisk)
obj.opossum.gabaergic <- LoadH5Seurat("E:/Opossum_M1/seurat/opossum_m1_gabaergic_raw.h5Seurat")
obj.opossum.gabaergic <- SCTransform(obj.opossum.gabaergic, vst.flavor = "v2", verbose = FALSE) %>%
RunPCA(npcs = 30, verbose = FALSE) %>%
RunUMAP(reduction = "pca", dims = 1:30, verbose = FALSE) %>%
FindNeighbors(reduction = "pca", dims = 1:30, verbose = FALSE) %>%
FindClusters(resolution = 2, algorithm = 4, method = "igraph")
obj.opossum.gabaergic$subclass <- NA
Idents(obj.opossum.gabaergic) <- "SCT_snn_res.2"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, idents = c("1", "2", "4", "5", "11", "13", "16", "19", "23"), invert = TRUE)
obj.opossum.gabaergic <- SCTransform(obj.opossum.gabaergic, vst.flavor = "v2", verbose = FALSE) %>%
RunPCA(npcs = 30, verbose = FALSE) %>%
RunUMAP(reduction = "pca", dims = 1:30, verbose = FALSE) %>%
FindNeighbors(reduction = "pca", dims = 1:30, verbose = FALSE) %>%
FindClusters(resolution = 1, algorithm = 4, method = "igraph")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "SCT_snn_res.2", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nFeature_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nCount_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
VlnPlot(obj.opossum.gabaergic, "nCount_RNA")
FeaturePlot(obj.opossum.gabaergic, "Plec", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sst"), min.cutoff = 0) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Pvalb"), min.cutoff = 0) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Vip"), min.cutoff = 0) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lamp5"), min.cutoff = 0) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sncg"), min.cutoff = 0) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Meis2"), min.cutoff = 0) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Chodl"), min.cutoff = 0) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lhx6"), min.cutoff = 0) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
levels(obj.opossum.gabaergic)
Idents(obj.opossum.gabaergic) <- "SCT_snn_res.1"
cells.pv <- WhichCells(obj.opossum.gabaergic, ident = c("2", "6", "7", "8", "11", "12"))
obj.opossum.gabaergic$subclass <- ifelse(colnames(obj.opossum.gabaergic) %in% cells.pv, "Pvalb", "ambiguous")
cells.sst <- WhichCells(obj.opossum.gabaergic, ident = c("1", "3", "9", "13", "16"))
obj.opossum.gabaergic$subclass[cells.sst] <- "Sst"
cells.vip <- WhichCells(obj.opossum.gabaergic, ident = c("5", "10", "14"))
obj.opossum.gabaergic$subclass[cells.vip] <- "Vip"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("4", "17"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Lamp5"
cells.meis2 <- WhichCells(obj.opossum.gabaergic, ident = c("15"))
obj.opossum.gabaergic$subclass[cells.meis2] <- "Meis2"
Idents(obj.opossum.gabaergic) <- "subclass"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, subset = subclass != "ambiguous")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
Idents(obj.opossum.gabaergic) <- "subclass"
obj.opossum.gabaergic.pvalb <- subset(obj.opossum.gabaergic, idents = "Pvalb")
# VlnPlot(obj.opossum.gabaergic.pvalb, "nCount_RNA", group.by = "SCT_snn_res.1")
# clustree(obj.opossum.gabaergic.pvalb, prefix = "SCT_snn_res.")
DefaultAssay(obj.opossum.gabaergic.pvalb) <- "RNA"
Idents(obj.opossum.gabaergic.pvalb) <- "SCT_snn_res.1"
all.markers.pvalb <- FindAllMarkers(obj.opossum.gabaergic.pvalb, only.pos = TRUE)
all.markers.pvalb.2 <- subset(all.markers.pvalb, cluster == 2)
all.markers.pvalb.6 <- subset(all.markers.pvalb, cluster == 6)
all.markers.pvalb.7 <- subset(all.markers.pvalb, cluster == 7)
all.markers.pvalb.8 <- subset(all.markers.pvalb, cluster == 8)
all.markers.pvalb.11 <- subset(all.markers.pvalb, cluster == 11)
all.markers.pvalb.12 <- subset(all.markers.pvalb, cluster == 12)
View(all.markers.pvalb.11)
View(all.markers.pvalb.12)
View(all.markers.pvalb.2)
View(all.markers.pvalb.6)
View(all.markers.pvalb.7)
View(all.markers.pvalb.8)
table(obj.opossum.gabaergic$sample)
table(obj.opossum.gabaergic$sample, obj.opossum.gabaergic$subclass)
library(tidyverse)
library(dplyr)
mouse.counts <- read.csv("G:/Shared drives/Opossum transcriptomics/figures/Figure_1_Mouse_Subclass_Sample.csv")
mouse.counts <- mouse.counts[-1, ]
rownames(mouse.counts) <- mouse.counts$X
mouse.counts <- mouse.counts[, -1]
mouse.counts$species <- "Mouse"
mouse.counts$L4.IT <- 0
mouse.counts$L6.IT.Car3 <- 0
mouse.counts$Stac <- 0
mouse.counts$Frem1 <- 0
mouse.counts$Lamp5_Lhx6 <- 0
mouse.counts$Chandelier <- 0
mouse.counts$Pax6 <- 0
mouse.counts$Sst <- mouse.counts$Sst + mouse.counts$Sst.Chodl
mouse.counts$Glutamatergic <- rowSums(mouse.counts[, c("L2.3.IT", "L5.ET", "L5.IT", "L5.6.NP", "L6.CT", "L6.IT", "L6b")])
mouse.counts$GABAergic <- rowSums(mouse.counts[, c("Pvalb", "Sst", "Vip", "Sncg", "Lamp5", "Meis2")])
mouse.counts$MGE <- rowSums(mouse.counts[, c("Pvalb", "Sst")])
mouse.counts$CGE <- rowSums(mouse.counts[, c("Vip", "Lamp5", "Sncg")])
mouse.counts$Neuronal <- rowSums(mouse.counts[, c("Glutamatergic", "GABAergic")])
mouse.counts$Nonneuronal <- rowSums(mouse.counts[, c("Astro", "Endo", "Micro.PVM", "Oligo", "OPC", "Peri", "SMC", "VLMC")])
opossum.counts <- read.csv("G:/Shared drives/Opossum transcriptomics/figures/Figure_1_Opossum_Subclass_Sample.csv")
rownames(opossum.counts) <- opossum.counts$X
opossum.counts <- opossum.counts[, -1]
opossum.counts$species <- "Opossum"
opossum.counts$L4.IT <- 0
opossum.counts$L6.IT <- 0
opossum.counts$Sncg <- 0
opossum.counts$SMC <- 0
opossum.counts$Stac <- 0
opossum.counts$Frem1 <- 0
opossum.counts$Lamp5_Lhx6 <- 0
opossum.counts$Chandelier <- 0
opossum.counts$L6.IT.Car3 <- 0
opossum.counts$Pax6 <- 0
opossum.counts$Sst.Chodl <- 0
opossum.counts$Peri <- 0
opossum.counts$Glutamatergic <- rowSums(opossum.counts[, c("L2.3.IT", "L5.ET", "L5.IT", "L5.6.NP", "L6.CT", "L6b")])
opossum.counts$GABAergic <- rowSums(opossum.counts[, c("Pvalb", "Sst", "Vip", "Lamp5")])
opossum.counts$MGE <- rowSums(opossum.counts[, c("Pvalb", "Sst")])
opossum.counts$CGE <- rowSums(opossum.counts[, c("Vip", "Lamp5", "Sncg")])
opossum.counts$Neuronal <- rowSums(opossum.counts[, c("Glutamatergic", "GABAergic")])
opossum.counts$Nonneuronal <- rowSums(opossum.counts[, c("Astro", "Endo", "Micro.PVM", "Oligo", "OPC", "Peri", "VLMC")])
both.counts <- rbind(mouse.counts, opossum.counts)
both.counts$sample <- rownames(both.counts)
both.counts <- both.counts %>%
mutate(L2.3.IT = L2.3.IT / Glutamatergic,
L5.ET = L5.ET / Glutamatergic,
L5.IT = L5.IT / Glutamatergic,
L5.6.NP = L5.6.NP / Glutamatergic,
L6.CT = L6.CT / Glutamatergic,
L6.IT = L6.IT / Glutamatergic,
L6b = L6b / Glutamatergic,
Pvalb_CGE = Pvalb / (Pvalb + CGE),
CGE_Pvalb = CGE / (CGE + Pvalb),
Pvalb = Pvalb / GABAergic,
Sst = Sst / GABAergic,
Vip = Vip / GABAergic,
Sncg = Sncg / GABAergic,
Lamp5 = Lamp5 / GABAergic,
Meis2 = Meis2 / GABAergic,
MGE = MGE / GABAergic,
CGE = CGE / GABAergic,
Glutamatergic = Glutamatergic / Neuronal,
GABAergic = GABAergic / Neuronal
)
scatter.counts <- both.counts
both.counts <- both.counts %>%
pivot_longer(
cols = c("L2.3.IT", "L5.ET", "L5.IT", "L5.6.NP", "L6.CT", "L6.IT", "L6b", "Pvalb", "Sst", "Vip", "Sncg", "Lamp5", "Meis2", "Glutamatergic", "GABAergic", "Nonneuronal", "Neuronal", "MGE", "CGE", "Pvalb_CGE", "CGE_Pvalb"),
names_to = "cell.identity",
values_to = "fraction"
)
both.counts$species <- factor(both.counts$species, levels = c("Opossum", "Mouse"))
class.counts <- both.counts[both.counts$cell.identity %in% c("Pvalb", "Sst", "Vip", "Sncg", "Lamp5"), ]
ggplot(class.counts, aes(x = factor(cell.identity, level = c("Pvalb", "Sst", "Vip", "Lamp5", "Sncg")), y = fraction, fill = species)) +
geom_bar(stat = "summary", fun = "median", position = position_dodge(width = 0.8), width = 0.75) +
geom_point(colour = "black", position = position_dodge(width = 0.8), size = 1) +
scale_x_discrete(labels = c("Pvalb", "Sst", "Vip", "Lamp5", "Sncg")) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75), expand = c(0, 0), limits = c(0, 0.751)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
theme_classic() + theme(axis.text = element_text(color = "black"), legend.text = element_text(size = 10)) +
labs(x = NULL, y = "Fraction of GABAergic Cells", fill = NULL) +
scale_fill_manual("legend", values = c("Opossum" = "#c692b8", "Mouse" = "#aaaaaa"))
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/MO_GABAergic_Subclass_Proportion.svg", plot=mo_gabaergic, width=4, height=3, dpi=500)
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/MO_GABAergic_Subclass_Proportion.png", plot=mo_gabaergic, width=4, height=3, dpi=500)
res.aov2 <- aov(fraction ~ species * cell.identity, data = class.counts)
tukey <- TukeyHSD(res.aov2, which = "species:cell.identity")
tukey
library(Seurat)
library(reticulate)
library(arrow)
library(ggplot2)
library(dplyr)
library(SeuratDisk)
obj.opossum.gabaergic <- LoadH5Seurat("E:/Opossum_M1/seurat/opossum_m1_gabaergic_raw.h5Seurat")
obj.opossum.gabaergic <- FindVariableFeatures(obj.opossum.gabaergic, selection.method = "vst", nfeatures = 5000)
all.genes <- rownames(obj.opossum.gabaergic)
obj.opossum.gabaergic <- ScaleData(obj.opossum.gabaergic, features = all.genes)
obj.opossum.gabaergic <- RunPCA(obj.opossum.gabaergic, features = VariableFeatures(object = obj.opossum.gabaergic))
ElbowPlot(obj.opossum.gabaergic, ndims = 50)
obj.opossum.gabaergic <- FindNeighbors(obj.opossum.gabaergic, dims = 1:30)
obj.opossum.gabaergic <- FindClusters(obj.opossum.gabaergic, resolution = 1, algorithm = 4, method = "igraph")
obj.opossum.gabaergic <- RunUMAP(obj.opossum.gabaergic, dims = 1:30, method="umap-learn")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nFeature_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nCount_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
VlnPlot(obj.opossum.gabaergic, "nCount_RNA")
obj.opossum.gabaergic <- FindNeighbors(obj.opossum.gabaergic, dims = 1:30)
obj.opossum.gabaergic <- FindClusters(obj.opossum.gabaergic, resolution = 2, algorithm = 4, method = "igraph")
obj.opossum.gabaergic <- RunUMAP(obj.opossum.gabaergic, dims = 1:30, method="umap-learn")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nFeature_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nCount_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
VlnPlot(obj.opossum.gabaergic, "nCount_RNA")
obj.opossum.gabaergic$subclass <- NA
Idents(obj.opossum.gabaergic) <- "RNA_snn_res.2"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, idents = c("1", "3", "8", "11", "14", "15", "18", "21", "26"), invert = TRUE)
obj.opossum.gabaergic <- FindVariableFeatures(obj.opossum.gabaergic, selection.method = "vst", nfeatures = 5000)
all.genes <- rownames(obj.opossum.gabaergic)
obj.opossum.gabaergic <- ScaleData(obj.opossum.gabaergic, features = all.genes)
obj.opossum.gabaergic <- RunPCA(obj.opossum.gabaergic, features = VariableFeatures(object = obj.opossum.gabaergic))
ElbowPlot(obj.opossum.gabaergic, ndims = 50)
obj.opossum.gabaergic <- FindNeighbors(obj.opossum.gabaergic, dims = 1:30)
obj.opossum.gabaergic <- FindClusters(obj.opossum.gabaergic, resolution = 2, algorithm = 4, method = "igraph")
obj.opossum.gabaergic <- RunUMAP(obj.opossum.gabaergic, dims = 1:30, method="umap-learn")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nFeature_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nCount_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
VlnPlot(obj.opossum.gabaergic, "nCount_RNA")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sst")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Pvalb")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Vip")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lamp5")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sncg")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Meis2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Chodl")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
obj.opossum.gabaergic <- FindNeighbors(obj.opossum.gabaergic, dims = 1:30)
obj.opossum.gabaergic <- FindClusters(obj.opossum.gabaergic, resolution = 1.5, algorithm = 4, method = "igraph")
obj.opossum.gabaergic <- RunUMAP(obj.opossum.gabaergic, dims = 1:30, method="umap-learn")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nFeature_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nCount_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
VlnPlot(obj.opossum.gabaergic, "nCount_RNA")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sst")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Pvalb")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Vip")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lamp5")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sncg")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Meis2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Chodl")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
Idents(obj.opossum.gabaergic) <- "RNA_snn_res.1"
cells.pv <- WhichCells(obj.opossum.gabaergic, ident = c("1", "3", "4", "6", "9", "12", "13"))
obj.opossum.gabaergic$subclass <- ifelse(colnames(obj.opossum.gabaergic) %in% cells.pv, "Pvalb", "ambiguous")
cells.sst <- WhichCells(obj.opossum.gabaergic, ident = c("7", "8", "10", "11", "15", "18"))
obj.opossum.gabaergic$subclass[cells.sst] <- "Sst"
cells.vip <- WhichCells(obj.opossum.gabaergic, ident = c("5", "14", "17"))
obj.opossum.gabaergic$subclass[cells.vip] <- "Vip"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("2", "19"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Lamp5"
cells.meis2 <- WhichCells(obj.opossum.gabaergic, ident = c("16"))
obj.opossum.gabaergic$subclass[cells.meis2] <- "Meis2"
Idents(obj.opossum.gabaergic) <- "subclass"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, subset = subclass != "ambiguous")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "subclass", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
Idents(obj.opossum.gabaergic) <- "RNA_snn_res.1.5"
cells.pv <- WhichCells(obj.opossum.gabaergic, ident = c("1", "3", "4", "6", "9", "12", "13"))
obj.opossum.gabaergic$subclass <- ifelse(colnames(obj.opossum.gabaergic) %in% cells.pv, "Pvalb", "ambiguous")
cells.sst <- WhichCells(obj.opossum.gabaergic, ident = c("7", "8", "10", "11", "15", "18"))
obj.opossum.gabaergic$subclass[cells.sst] <- "Sst"
cells.vip <- WhichCells(obj.opossum.gabaergic, ident = c("5", "14", "17"))
obj.opossum.gabaergic$subclass[cells.vip] <- "Vip"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("2", "19"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Lamp5"
cells.meis2 <- WhichCells(obj.opossum.gabaergic, ident = c("16"))
obj.opossum.gabaergic$subclass[cells.meis2] <- "Meis2"
Idents(obj.opossum.gabaergic) <- "subclass"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, subset = subclass != "ambiguous")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "subclass", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
Idents(obj.opossum.gabaergic) <- "subclass"
obj.opossum.gabaergic.pvalb <- subset(obj.opossum.gabaergic, idents = "Pvalb")
# VlnPlot(obj.opossum.gabaergic.pvalb, "nCount_RNA", group.by = "SCT_snn_res.1")
# clustree(obj.opossum.gabaergic.pvalb, prefix = "SCT_snn_res.")
DefaultAssay(obj.opossum.gabaergic.pvalb) <- "RNA"
Idents(obj.opossum.gabaergic.pvalb) <- "RNA_snn_res.1.5"
all.markers.pvalb <- FindAllMarkers(obj.opossum.gabaergic.pvalb, only.pos = TRUE)
all.markers.pvalb.1 <- subset(all.markers.pvalb, cluster == 1)
all.markers.pvalb.3 <- subset(all.markers.pvalb, cluster == 3)
all.markers.pvalb.4 <- subset(all.markers.pvalb, cluster == 4)
all.markers.pvalb.6 <- subset(all.markers.pvalb, cluster == 6)
all.markers.pvalb.9 <- subset(all.markers.pvalb, cluster == 9)
all.markers.pvalb.12 <- subset(all.markers.pvalb, cluster == 12)
all.markers.pvalb.13 <- subset(all.markers.pvalb, cluster == 13)
View(all.markers.pvalb.1)
View(all.markers.pvalb.3)
View(all.markers.pvalb.4)
View(all.markers.pvalb.6)
View(all.markers.pvalb.9)
obj.opossum.gabaergic <- FindClusters(obj.opossum.gabaergic, resolution = 1.1, algorithm = 4, method = "igraph")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nFeature_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nCount_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
VlnPlot(obj.opossum.gabaergic, "nCount_RNA")
Idents(obj.opossum.gabaergic) <- "RNA_snn_res.1.5"
cells.pv <- WhichCells(obj.opossum.gabaergic, ident = c("1", "3", "4", "6", "12", "13"))
obj.opossum.gabaergic$subclass <- ifelse(colnames(obj.opossum.gabaergic) %in% cells.pv, "Pvalb", "ambiguous")
cells.sst <- WhichCells(obj.opossum.gabaergic, ident = c("7", "8", "10", "11", "15", "18"))
obj.opossum.gabaergic$subclass[cells.sst] <- "Sst"
cells.vip <- WhichCells(obj.opossum.gabaergic, ident = c("5", "14", "17"))
obj.opossum.gabaergic$subclass[cells.vip] <- "Vip"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("2", "19"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Lamp5"
cells.meis2 <- WhichCells(obj.opossum.gabaergic, ident = c("16"))
obj.opossum.gabaergic$subclass[cells.meis2] <- "Meis2"
Idents(obj.opossum.gabaergic) <- "subclass"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, subset = subclass != "ambiguous")
table(obj.opossum.gabaergic$sample, obj.opossum.gabaergic$subclass)
obj.opossum.gabaergic <- FindNeighbors(obj.opossum.gabaergic, dims = 1:30)
obj.opossum.gabaergic <- FindClusters(obj.opossum.gabaergic, resolution = 1.1, algorithm = 4, method = "igraph")
obj.opossum.gabaergic <- RunUMAP(obj.opossum.gabaergic, dims = 1:30, method="umap-learn")
obj.opossum.gabaergic <- FindVariableFeatures(obj.opossum.gabaergic, selection.method = "vst", nfeatures = 5000)
all.genes <- rownames(obj.opossum.gabaergic)
obj.opossum.gabaergic <- ScaleData(obj.opossum.gabaergic, features = all.genes)
obj.opossum.gabaergic <- RunPCA(obj.opossum.gabaergic, features = VariableFeatures(object = obj.opossum.gabaergic))
ElbowPlot(obj.opossum.gabaergic, ndims = 50)
obj.opossum.gabaergic <- FindNeighbors(obj.opossum.gabaergic, dims = 1:30)
obj.opossum.gabaergic <- FindClusters(obj.opossum.gabaergic, resolution = 1.1, algorithm = 4, method = "igraph")
obj.opossum.gabaergic <- RunUMAP(obj.opossum.gabaergic, dims = 1:30, method="umap-learn")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nFeature_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nCount_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
VlnPlot(obj.opossum.gabaergic, "nCount_RNA")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sst")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Pvalb")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Vip")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lamp5")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sncg")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Meis2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Chodl")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
Idents(obj.opossum.gabaergic) <- "RNA_snn_res.1.5"
cells.pv <- WhichCells(obj.opossum.gabaergic, ident = c("2", "4", "5", "6", "10", "12"))
obj.opossum.gabaergic$subclass <- ifelse(colnames(obj.opossum.gabaergic) %in% cells.pv, "Pvalb", "ambiguous")
cells.sst <- WhichCells(obj.opossum.gabaergic, ident = c("1", "8", "9", "13", "16", "17"))
Idents(obj.opossum.gabaergic) <- "RNA_snn_res.1.1"
cells.pv <- WhichCells(obj.opossum.gabaergic, ident = c("2", "4", "5", "6", "10", "12"))
obj.opossum.gabaergic$subclass <- ifelse(colnames(obj.opossum.gabaergic) %in% cells.pv, "Pvalb", "ambiguous")
cells.sst <- WhichCells(obj.opossum.gabaergic, ident = c("1", "8", "9", "13", "16", "17"))
obj.opossum.gabaergic$subclass[cells.sst] <- "Sst"
cells.vip <- WhichCells(obj.opossum.gabaergic, ident = c("7", "11", "15"))
obj.opossum.gabaergic$subclass[cells.vip] <- "Vip"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("3", "18"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Lamp5"
cells.meis2 <- WhichCells(obj.opossum.gabaergic, ident = c("14"))
obj.opossum.gabaergic$subclass[cells.meis2] <- "Meis2"
Idents(obj.opossum.gabaergic) <- "subclass"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, subset = subclass != "ambiguous")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "subclass", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
Idents(obj.opossum.gabaergic) <- "subclass"
obj.opossum.gabaergic.pvalb <- subset(obj.opossum.gabaergic, idents = "Pvalb")
# VlnPlot(obj.opossum.gabaergic.pvalb, "nCount_RNA", group.by = "SCT_snn_res.1")
# clustree(obj.opossum.gabaergic.pvalb, prefix = "SCT_snn_res.")
DefaultAssay(obj.opossum.gabaergic.pvalb) <- "RNA"
Idents(obj.opossum.gabaergic.pvalb) <- "RNA_snn_res.1.1"
all.markers.pvalb <- FindAllMarkers(obj.opossum.gabaergic.pvalb, only.pos = TRUE)
rm(all.markers.pvalb.1)
rm(all.markers.pvalb.12)
rm(all.markers.pvalb.13)
rm(all.markers.pvalb.3)
rm(all.markers.pvalb.4)
rm(all.markers.pvalb.6)
rm(all.markers.pvalb.9)
all.markers.pvalb.2 <- subset(all.markers.pvalb, cluster == 2)
all.markers.pvalb.4 <- subset(all.markers.pvalb, cluster == 4)
all.markers.pvalb.5 <- subset(all.markers.pvalb, cluster == 5)
all.markers.pvalb.6 <- subset(all.markers.pvalb, cluster == 6)
all.markers.pvalb.10 <- subset(all.markers.pvalb, cluster == 10)
all.markers.pvalb.12 <- subset(all.markers.pvalb, cluster == 12)
View(all.markers.pvalb.2)
View(all.markers.pvalb.4)
View(all.markers.pvalb.5)
View(all.markers.pvalb.6)
View(all.markers.pvalb.10)
View(all.markers.pvalb.12)
table(obj.opossum.gabaergic$sample)
table(obj.opossum.gabaergic$sample, obj.opossum.gabaergic$subclass)
library(tidyverse)
library(dplyr)
mouse.counts <- read.csv("G:/Shared drives/Opossum transcriptomics/figures/Figure_1_Mouse_Subclass_Sample.csv")
mouse.counts <- mouse.counts[-1, ]
rownames(mouse.counts) <- mouse.counts$X
mouse.counts <- mouse.counts[, -1]
mouse.counts$species <- "Mouse"
mouse.counts$L4.IT <- 0
mouse.counts$L6.IT.Car3 <- 0
mouse.counts$Stac <- 0
mouse.counts$Frem1 <- 0
mouse.counts$Lamp5_Lhx6 <- 0
mouse.counts$Chandelier <- 0
mouse.counts$Pax6 <- 0
mouse.counts$Sst <- mouse.counts$Sst + mouse.counts$Sst.Chodl
mouse.counts$Glutamatergic <- rowSums(mouse.counts[, c("L2.3.IT", "L5.ET", "L5.IT", "L5.6.NP", "L6.CT", "L6.IT", "L6b")])
mouse.counts$GABAergic <- rowSums(mouse.counts[, c("Pvalb", "Sst", "Vip", "Sncg", "Lamp5", "Meis2")])
mouse.counts$MGE <- rowSums(mouse.counts[, c("Pvalb", "Sst")])
mouse.counts$CGE <- rowSums(mouse.counts[, c("Vip", "Lamp5", "Sncg")])
mouse.counts$Neuronal <- rowSums(mouse.counts[, c("Glutamatergic", "GABAergic")])
mouse.counts$Nonneuronal <- rowSums(mouse.counts[, c("Astro", "Endo", "Micro.PVM", "Oligo", "OPC", "Peri", "SMC", "VLMC")])
opossum.counts <- read.csv("G:/Shared drives/Opossum transcriptomics/figures/Figure_1_Opossum_Subclass_Sample.csv")
rownames(opossum.counts) <- opossum.counts$X
opossum.counts <- opossum.counts[, -1]
opossum.counts$species <- "Opossum"
opossum.counts$L4.IT <- 0
opossum.counts$L6.IT <- 0
opossum.counts$Sncg <- 0
opossum.counts$SMC <- 0
opossum.counts$Stac <- 0
opossum.counts$Frem1 <- 0
opossum.counts$Lamp5_Lhx6 <- 0
opossum.counts$Chandelier <- 0
opossum.counts$L6.IT.Car3 <- 0
opossum.counts$Pax6 <- 0
opossum.counts$Sst.Chodl <- 0
opossum.counts$Peri <- 0
opossum.counts$Glutamatergic <- rowSums(opossum.counts[, c("L2.3.IT", "L5.ET", "L5.IT", "L5.6.NP", "L6.CT", "L6b")])
opossum.counts$GABAergic <- rowSums(opossum.counts[, c("Pvalb", "Sst", "Vip", "Lamp5")])
opossum.counts$MGE <- rowSums(opossum.counts[, c("Pvalb", "Sst")])
opossum.counts$CGE <- rowSums(opossum.counts[, c("Vip", "Lamp5", "Sncg")])
opossum.counts$Neuronal <- rowSums(opossum.counts[, c("Glutamatergic", "GABAergic")])
opossum.counts$Nonneuronal <- rowSums(opossum.counts[, c("Astro", "Endo", "Micro.PVM", "Oligo", "OPC", "Peri", "VLMC")])
both.counts <- rbind(mouse.counts, opossum.counts)
both.counts$sample <- rownames(both.counts)
both.counts <- both.counts %>%
mutate(L2.3.IT = L2.3.IT / Glutamatergic,
L5.ET = L5.ET / Glutamatergic,
L5.IT = L5.IT / Glutamatergic,
L5.6.NP = L5.6.NP / Glutamatergic,
L6.CT = L6.CT / Glutamatergic,
L6.IT = L6.IT / Glutamatergic,
L6b = L6b / Glutamatergic,
Pvalb_CGE = Pvalb / (Pvalb + CGE),
CGE_Pvalb = CGE / (CGE + Pvalb),
Pvalb = Pvalb / GABAergic,
Sst = Sst / GABAergic,
Vip = Vip / GABAergic,
Sncg = Sncg / GABAergic,
Lamp5 = Lamp5 / GABAergic,
Meis2 = Meis2 / GABAergic,
MGE = MGE / GABAergic,
CGE = CGE / GABAergic,
Glutamatergic = Glutamatergic / Neuronal,
GABAergic = GABAergic / Neuronal
)
scatter.counts <- both.counts
both.counts <- both.counts %>%
pivot_longer(
cols = c("L2.3.IT", "L5.ET", "L5.IT", "L5.6.NP", "L6.CT", "L6.IT", "L6b", "Pvalb", "Sst", "Vip", "Sncg", "Lamp5", "Meis2", "Glutamatergic", "GABAergic", "Nonneuronal", "Neuronal", "MGE", "CGE", "Pvalb_CGE", "CGE_Pvalb"),
names_to = "cell.identity",
values_to = "fraction"
)
both.counts$species <- factor(both.counts$species, levels = c("Opossum", "Mouse"))
class.counts <- both.counts[both.counts$cell.identity %in% c("Pvalb", "Sst", "Vip", "Sncg", "Lamp5"), ]
ggplot(class.counts, aes(x = factor(cell.identity, level = c("Pvalb", "Sst", "Vip", "Lamp5", "Sncg")), y = fraction, fill = species)) +
geom_bar(stat = "summary", fun = "median", position = position_dodge(width = 0.8), width = 0.75) +
geom_point(colour = "black", position = position_dodge(width = 0.8), size = 1) +
scale_x_discrete(labels = c("Pvalb", "Sst", "Vip", "Lamp5", "Sncg")) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75), expand = c(0, 0), limits = c(0, 0.751)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
theme_classic() + theme(axis.text = element_text(color = "black"), legend.text = element_text(size = 10)) +
labs(x = NULL, y = "Fraction of GABAergic Cells", fill = NULL) +
scale_fill_manual("legend", values = c("Opossum" = "#c692b8", "Mouse" = "#aaaaaa"))
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/MO_GABAergic_Subclass_Proportion.svg", plot=mo_gabaergic, width=4, height=3, dpi=500)
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/MO_GABAergic_Subclass_Proportion.png", plot=mo_gabaergic, width=4, height=3, dpi=500)
library(Seurat)
library(reticulate)
library(arrow)
library(ggplot2)
library(dplyr)
library(SeuratDisk)
obj.opossum.gabaergic <- LoadH5Seurat("E:/Opossum_M1/seurat/opossum_m1_gabaergic_raw.h5Seurat")
