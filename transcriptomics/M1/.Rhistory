FeaturePlot(obj.opossum, reduction = "umap", features = c("Aldh1l1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Col1a1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Pvalb"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Snap25"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Slc17a6"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Gad2"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
# FeaturePlot(obj.opossum, reduction = "umap", features = c("Csf1R"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Mog"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
# FeaturePlot(obj.opossum, reduction = "umap", features = c("PDGFRA"), raster = FALSE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Aldh1l1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Col1a1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("PVALB"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Sst"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Vip"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Lamp5"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Sncg"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
obj.opossum <- SplitObject(obj.opossum, split.by = "sample")
for (sample in names(obj.opossum)) {
obj.opossum[[sample]] <- SCTransform(obj.opossum[[sample]], vst.flavor = "v2", verbose = FALSE) %>%
RunPCA(npcs = 30, verbose = FALSE)
}
features <- SelectIntegrationFeatures(object.list = obj.opossum, nfeatures = 3000)
obj.opossum.gabaergic <- PrepSCTIntegration(object.list = obj.opossum, anchor.features = features)
obj.opossum.anchors <- FindIntegrationAnchors(object.list = obj.opossum, normalization.method = "SCT", anchor.features = features)
features <- SelectIntegrationFeatures(object.list = obj.opossum, nfeatures = 3000)
obj.opossum <- PrepSCTIntegration(object.list = obj.opossum, anchor.features = features)
obj.opossum.anchors <- FindIntegrationAnchors(object.list = obj.opossum, normalization.method = "SCT", anchor.features = features)
obj.opossum.sct <- IntegrateData(anchorset = obj.opossum.anchors, normalization.method = "SCT")
obj.opossum.sct <- RunPCA(obj.opossum.sct, verbose = FALSE)
obj.opossum.sct <- RunUMAP(obj.opossum.sct, dims = 1:30, method = "umap-learn", reduction = "pca")
obj.opossum.sct <- FindNeighbors(obj.opossum.sct, reduction = "pca", dims = 1:30)
obj.opossum.sct <- FindClusters(obj.opossum.sct, resolution = 1, algorithm = 4, method = "igraph")
DimPlot(obj.opossum, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.sct, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.sct, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, "nFeature_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, "nCount_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.sct, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Snap25"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Slc17a6"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Gad2"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
# FeaturePlot(obj.opossum, reduction = "umap", features = c("Csf1R"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Mog"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
# FeaturePlot(obj.opossum, reduction = "umap", features = c("PDGFRA"), raster = FALSE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Aldh1l1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Col1a1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Snap25"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Slc17a6"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Gad2"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
# FeaturePlot(obj.opossum, reduction = "umap", features = c("Csf1R"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Mog"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
# FeaturePlot(obj.opossum, reduction = "umap", features = c("PDGFRA"), raster = FALSE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Aldh1l1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
# FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Col1a1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("PVALB"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Sst"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Vip"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Lamp5"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.sct, reduction = "umap", features = c("Sncg"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
SaveH5Seurat(obj.opossum, "E:/Opossum_V1/seurat/opossum_v1_all.h5seurat", overwrite = TRUE, verbose = TRUE)
SaveH5Seurat(obj.opossum.sct, "E:/Opossum_V1/seurat/opossum_v1_all.h5seurat", overwrite = TRUE, verbose = TRUE)
DimPlot(obj.opossum, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
obj.opossum <- obj.opossum.sct
DimPlot(obj.opossum, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
DimPlot(obj.opossum, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
DimPlot(obj.opossum, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-15, 15) + ylim(-15, 15) + coord_equal()
DimPlot(obj.opossum, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum, reduction = "umap", group.by = "sample", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Snap25"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Gad2"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Csf1r"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Mog"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Pdgfra"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Aldh1l1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Col1a1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Snap25"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Gad2"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Csf1r"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Mog"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Pdgfra"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Aldh1l1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
# FeaturePlot(obj.opossum, reduction = "umap", features = c("Col1a1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Slc17a6"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Slc17a7"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
rownames(obj.opossum)
"SLC17A7" %in% rownames(obj.opossum)
"Slc17a6" %in% rownames(obj.opossum)
FeaturePlot(obj.opossum, reduction = "umap", features = c("Snap25"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Gad2"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Csf1r"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Mog"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Pdgfra"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Aldh1l1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
# FeaturePlot(obj.opossum, reduction = "umap", features = c("Col1a1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Slc17a6"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
# FeaturePlot(obj.opossum, reduction = "umap", features = c("Slc17a7"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Gad1"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Lhx6"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Adarb2"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("PVALB"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Sst"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Vip"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum, reduction = "umap", features = c("Lamp5"), raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
cells.glutamatergic <- WhichCells(obj.opossum, ident = c(1))
obj.opossum$class <- ifelse(colnames(obj.opossum) %in% cells.glutamatergic, "glutamatergic", "ambiguous")
cells.gabaergic <- WhichCells(obj.opossum, ident = c(9, 17, 21, 27))
obj.opossum$class[cells.gabaergic] <- "gabaergic"
# cells.nonneuronal <- WhichCells(obj.opossum, ident = c(8, 10, 21, 23, 25, 26, 27, 29))
# obj.opossum$class[cells.nonneuronal] <- "nonneuronal"
# obj.opossum.glutamatergic <- subset(obj.opossum, subset = class == "glutamatergic")
# SaveH5Seurat(obj.opossum.glutamatergic, "E:/Opossum_M1/seurat/opossum_m1_glutamatergic_raw.h5seurat", overwrite = TRUE, verbose = TRUE)
obj.opossum.gabaergic <- subset(obj.opossum, subset = class == "gabaergic")
SaveH5Seurat(obj.opossum.gabaergic, "E:/Opossum_V1/seurat/opossum_v1_gabaergic.h5seurat", overwrite = TRUE, verbose = TRUE)
# obj.opossum.nonneuronal <- subset(obj.opossum, subset = class == "nonneuronal")
# SaveH5Seurat(obj.opossum.nonneuronal, "E:/Opossum_M1/seurat/opossum_m1_nonneuronal_raw.h5seurat", overwrite = TRUE, verbose = TRUE)
obj.opossum.gabaergic <- FindVariableFeatures(obj.opossum.gabaergic, selection.method = "vst", nfeatures = 3000)
all.genes <- rownames(obj.opossum.gabaergic)
obj.opossum.gabaergic <- ScaleData(obj.opossum.gabaergic, features = all.genes)
obj.opossum.gabaergic <- RunPCA(obj.opossum.gabaergic, features = VariableFeatures(object = obj.opossum.gabaergic))
ElbowPlot(obj.opossum.gabaergic, ndims = 50)
obj.opossum.gabaergic <- FindNeighbors(obj.opossum.gabaergic, dims = 1:30)
obj.opossum.gabaergic <- FindClusters(obj.opossum.gabaergic, resolution = 1, algorithm = 4, method = "igraph")
obj.opossum.gabaergic <- RunUMAP(obj.opossum.gabaergic, dims = 1:30, method="umap-learn")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "sample", raster = FALSE, shuffle = TRUE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nFeature_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nCount_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
VlnPlot(obj.opossum.gabaergic, "nCount_RNA")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("PVALB")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sst")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Vip")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lamp5")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sncg")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("PVALB")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sst")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Vip")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lamp5")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
# FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sncg")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Meis2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Chodl")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
"CHODL" %in% rownames(obj.opossum)
"Chodl" %in% rownames(obj.opossum)
obj.opossum
rownames(obj.opossum)
DefaultAssay(obj.opossum.gabaergic) <- "RNA"
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("PVALB")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sst")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Vip")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lamp5")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sncg")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Meis2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Chodl")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
# FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Adarb2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DefaultAssay(obj.opossum.gabaergic) <- "RNA"
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("PVALB")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sst")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Vip")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lamp5")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sncg")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Meis2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Chodl")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lhx6")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Adarb2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
obj.opossum.gabaergic$subclass <- NA
Idents(obj.opossum.gabaergic) <- "RNA_snn_res.1"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, idents = c("6", "10", "11", "13"), invert = TRUE)
Idents(obj.opossum.gabaergic)
DefaultAssay(obj.opossum.gabaergic) <- "SCT"
obj.opossum.gabaergic$subclass <- NA
Idents(obj.opossum.gabaergic) <- "RNA_snn_res.1"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, idents = c("6", "10", "11", "13"), invert = TRUE)
obj.opossum.gabaergic$subclass <- NA
Idents(obj.opossum.gabaergic) <- "SCT_snn_res.1"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, idents = c("6", "10", "11", "13"), invert = TRUE)
Idents(obj.opossum.gabaergic)
obj.opossum.gabaergic <- FindNeighbors(obj.opossum.gabaergic, dims = 1:30)
obj.opossum.gabaergic <- FindClusters(obj.opossum.gabaergic, resolution = 1, algorithm = 4, method = "igraph")
obj.opossum.gabaergic <- FindVariableFeatures(obj.opossum.gabaergic, selection.method = "vst", nfeatures = 3000)
DefaultAssay(obj.opossum.gabaergic) <- "SCT"
obj.opossum.gabaergic <- FindVariableFeatures(obj.opossum.gabaergic, selection.method = "vst", nfeatures = 3000)
obj.opossum.gabaergic <- FindNeighbors(obj.opossum.gabaergic, dims = 1:30)
obj.opossum.gabaergic <- FindClusters(obj.opossum.gabaergic, resolution = 1, algorithm = 4, method = "igraph")
library(Seurat)
library(reticulate)
library(arrow)
library(ggplot2)
library(dplyr)
library(SeuratDisk)
obj.opossum.gabaergic <- LoadH5Seurat("E:/Opossum_V1/seurat/opossum_v1_gabaergic.h5Seurat")
# DefaultAssay(obj.opossum.gabaergic) <- "SCT"
obj.opossum.gabaergic <- FindVariableFeatures(obj.opossum.gabaergic, selection.method = "vst", nfeatures = 3000)
all.genes <- rownames(obj.opossum.gabaergic)
obj.opossum.gabaergic <- ScaleData(obj.opossum.gabaergic, features = all.genes)
obj.opossum.gabaergic <- RunPCA(obj.opossum.gabaergic, features = VariableFeatures(object = obj.opossum.gabaergic))
ElbowPlot(obj.opossum.gabaergic, ndims = 50)
obj.opossum.gabaergic <- FindNeighbors(obj.opossum.gabaergic, dims = 1:30)
obj.opossum.gabaergic <- FindClusters(obj.opossum.gabaergic, resolution = 1, algorithm = 4, method = "igraph")
obj.opossum.gabaergic <- RunUMAP(obj.opossum.gabaergic, dims = 1:30, method="umap-learn")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "sample", raster = FALSE, shuffle = TRUE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nFeature_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nCount_RNA", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "predicted_doublets", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
VlnPlot(obj.opossum.gabaergic, "nCount_RNA")
obj.opossum.gabaergic
obj.opossum.gabaergic[[]]
obj.opossum.gabaergic$subclass <- NA
Idents(obj.opossum.gabaergic) <- "integrated_snn_res.1"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, idents = c("6", "10", "11", "13"), invert = TRUE)
obj.opossum.gabaergic <- FindVariableFeatures(obj.opossum.gabaergic, selection.method = "vst", nfeatures = 3000)
all.genes <- rownames(obj.opossum.gabaergic)
obj.opossum.gabaergic <- ScaleData(obj.opossum.gabaergic, features = all.genes)
obj.opossum.gabaergic <- RunPCA(obj.opossum.gabaergic, features = VariableFeatures(object = obj.opossum.gabaergic))
ElbowPlot(obj.opossum.gabaergic, ndims = 50)
obj.opossum.gabaergic <- FindNeighbors(obj.opossum.gabaergic, dims = 1:30)
obj.opossum.gabaergic <- FindClusters(obj.opossum.gabaergic, resolution = 1.1, algorithm = 4, method = "igraph")
obj.opossum.gabaergic <- RunUMAP(obj.opossum.gabaergic, dims = 1:30, method="umap-learn")
obj.opossum.gabaergic[[]]
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "integrated_snn_res.1.1", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "sample", raster = FALSE, shuffle = TRUE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nCount_RNA", min.cutoff = 0, max.cutoff = 20000) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, "nFeature_RNA", min.cutoff = 0, max.cutoff = 6500) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
VlnPlot(obj.opossum.gabaergic, group.by = "integrated_snn_res.1.1", "nCount_RNA") + ylim(0, 40000)
VlnPlot(obj.opossum.gabaergic, group.by = "integrated_snn_res.1", "nFeature_RNA") + ylim(0, 6500)
obj.opossum.gabaergic
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("PVALB")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sst")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Vip")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lamp5")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sncg")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DefaultAssay(obj.opossum.gabaergic) <- "RNA"
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("PVALB")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sst")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Vip")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lamp5")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sncg")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Meis2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Chodl")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Adarb2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DefaultAssay(obj.opossum.gabaergic) <- "RNA"
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("PVALB")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sst")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Vip")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lamp5")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sncg")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Meis2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Chodl")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lhx6")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Adarb2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
Idents(obj.opossum.gabaergic) <- "RNA_snn_res.1.1"
cells.pv <- WhichCells(obj.opossum.gabaergic, ident = c("1", "3", "6", "8", "11"))
Idents(obj.opossum.gabaergic) <- "integrated_snn_res.1.1"
cells.pv <- WhichCells(obj.opossum.gabaergic, ident = c("1", "3", "6", "8", "11"))
obj.opossum.gabaergic$subclass <- ifelse(colnames(obj.opossum.gabaergic) %in% cells.pv, "Pvalb", "ambiguous")
cells.sst <- WhichCells(obj.opossum.gabaergic, ident = c("4", "7", "10"))
obj.opossum.gabaergic$subclass[cells.sst] <- "Sst"
cells.vip <- WhichCells(obj.opossum.gabaergic, ident = c("2", "9"))
obj.opossum.gabaergic$subclass[cells.vip] <- "Vip"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("5"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Lamp5"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("15"))
Idents(obj.opossum.gabaergic) <- "integrated_snn_res.1.1"
cells.pv <- WhichCells(obj.opossum.gabaergic, ident = c("1", "3", "6", "8", "11"))
obj.opossum.gabaergic$subclass <- ifelse(colnames(obj.opossum.gabaergic) %in% cells.pv, "Pvalb", "ambiguous")
cells.sst <- WhichCells(obj.opossum.gabaergic, ident = c("4", "7", "10"))
obj.opossum.gabaergic$subclass[cells.sst] <- "Sst"
cells.vip <- WhichCells(obj.opossum.gabaergic, ident = c("2", "9"))
obj.opossum.gabaergic$subclass[cells.vip] <- "Vip"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("5"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Lamp5"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("12"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Meis2"
Idents(obj.opossum.gabaergic) <- "subclass"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, subset = subclass != "ambiguous")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "subclass", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
table(obj.opossum.gabaergic$sample, obj.opossum.gabaergic$subclass)
rownames(obj.opossum.gabaergic)
"Frem1" %in% rownames(obj.opossum.gabaergic)
"Stac" %in% rownames(obj.opossum.gabaergic)
"STAC" %in% rownames(obj.opossum.gabaergic)
DefaultAssay(obj.opossum.gabaergic) <- "RNA"
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("PVALB")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sst")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Vip")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lamp5")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Frem1")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Sncg")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Meis2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Chodl")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Lhx6")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
FeaturePlot(obj.opossum.gabaergic, reduction = "umap", features = c("Adarb2")) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
Idents(obj.opossum.gabaergic) <- "integrated_snn_res.1.1"
cells.pv <- WhichCells(obj.opossum.gabaergic, ident = c("1", "3", "6", "8", "11"))
obj.opossum.gabaergic$subclass <- ifelse(colnames(obj.opossum.gabaergic) %in% cells.pv, "Pvalb", "ambiguous")
cells.sst <- WhichCells(obj.opossum.gabaergic, ident = c("4", "7", "10"))
obj.opossum.gabaergic$subclass[cells.sst] <- "Sst"
cells.vip <- WhichCells(obj.opossum.gabaergic, ident = c("2"))
obj.opossum.gabaergic$subclass[cells.vip] <- "Vip"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("5"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Lamp5"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("9"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Frem1"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("12"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Meis2"
Idents(obj.opossum.gabaergic) <- "subclass"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, subset = subclass != "ambiguous")
Idents(obj.opossum.gabaergic) <- "integrated_snn_res.1.1"
cells.pv <- WhichCells(obj.opossum.gabaergic, ident = c("1", "3", "6", "8", "11"))
obj.opossum.gabaergic$subclass <- ifelse(colnames(obj.opossum.gabaergic) %in% cells.pv, "Pvalb", "ambiguous")
cells.sst <- WhichCells(obj.opossum.gabaergic, ident = c("4", "7", "10"))
obj.opossum.gabaergic$subclass[cells.sst] <- "Sst"
cells.vip <- WhichCells(obj.opossum.gabaergic, ident = c("2"))
obj.opossum.gabaergic$subclass[cells.vip] <- "Vip"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("5"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Lamp5"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("9"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Frem1"
cells.lamp5 <- WhichCells(obj.opossum.gabaergic, ident = c("12"))
obj.opossum.gabaergic$subclass[cells.lamp5] <- "Meis2"
Idents(obj.opossum.gabaergic) <- "subclass"
obj.opossum.gabaergic <- subset(obj.opossum.gabaergic, subset = subclass != "ambiguous")
DimPlot(obj.opossum.gabaergic, reduction = "umap", label = TRUE, raster = FALSE) + NoLegend() + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
DimPlot(obj.opossum.gabaergic, reduction = "umap", group.by = "subclass", raster = FALSE) + xlim(-18, 18) + ylim(-18, 18) + coord_equal()
table(obj.opossum.gabaergic$sample, obj.opossum.gabaergic$subclass)
library(tidyverse)
library(dplyr)
mouse.counts <- read.csv("G:/Shared drives/Opossum transcriptomics/figures/Mouse_Subclass_Sample_v1.csv")
mouse.counts <- mouse.counts[-1, ]
rownames(mouse.counts) <- mouse.counts$X
mouse.counts <- mouse.counts[, -1]
mouse.counts$species <- "Mouse"
mouse.counts$GABAergic <- rowSums(mouse.counts[, c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Meis2")])
opossum.counts <- read.csv("G:/Shared drives/Opossum transcriptomics/figures/Opossum_Subclass_Sample_V1.csv")
rownames(opossum.counts) <- opossum.counts$X
opossum.counts <- opossum.counts[, -1]
opossum.counts$species <- "Opossum"
opossum.counts$GABAergic <- rowSums(opossum.counts[, c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Meis2")])
both.counts <- rbind(mouse.counts, opossum.counts)
both.counts$sample <- rownames(both.counts)
both.counts <- both.counts %>%
mutate(Pvalb = Pvalb / GABAergic,
Sst = Sst / GABAergic,
Vip = Vip / GABAergic,
Sncg = Sncg / GABAergic,
Lamp5 = Lamp5 / GABAergic,
Frem1 = Frem1 / GABAergic,
Meis2 = Meis2 / GABAergic
)
both.counts <- both.counts %>%
mutate(Pvalb = Pvalb / GABAergic,
Sst = Sst / GABAergic,
Vip = Vip / GABAergic,
Lamp5 = Lamp5 / GABAergic,
Frem1 = Frem1 / GABAergic,
Meis2 = Meis2 / GABAergic
)
scatter.counts <- both.counts
both.counts <- both.counts %>%
pivot_longer(
cols = c("Pvalb", "Sst", "Vip", "Sncg", "Lamp5", "Frem1", "Meis2"),
names_to = "cell.identity",
values_to = "fraction"
)
library(tidyverse)
library(dplyr)
mouse.counts <- read.csv("G:/Shared drives/Opossum transcriptomics/figures/Mouse_Subclass_Sample_v1.csv")
mouse.counts <- mouse.counts[-1, ]
rownames(mouse.counts) <- mouse.counts$X
mouse.counts <- mouse.counts[, -1]
mouse.counts$species <- "Mouse"
mouse.counts$GABAergic <- rowSums(mouse.counts[, c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Meis2")])
opossum.counts <- read.csv("G:/Shared drives/Opossum transcriptomics/figures/Opossum_Subclass_Sample_V1.csv")
rownames(opossum.counts) <- opossum.counts$X
opossum.counts <- opossum.counts[, -1]
opossum.counts$species <- "Opossum"
opossum.counts$GABAergic <- rowSums(opossum.counts[, c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Meis2")])
both.counts <- rbind(mouse.counts, opossum.counts)
both.counts$sample <- rownames(both.counts)
both.counts <- both.counts %>%
mutate(Pvalb = Pvalb / GABAergic,
Sst = Sst / GABAergic,
Vip = Vip / GABAergic,
Lamp5 = Lamp5 / GABAergic,
Frem1 = Frem1 / GABAergic,
Meis2 = Meis2 / GABAergic
)
scatter.counts <- both.counts
both.counts <- both.counts %>%
pivot_longer(
cols = c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Meis2"),
names_to = "cell.identity",
values_to = "fraction"
)
both.counts$species <- factor(both.counts$species, levels = c("Opossum", "Mouse", "Human"))
class.counts <- both.counts[both.counts$cell.identity %in% c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Meis2"), ]
ggplot(class.counts, aes(x = factor(cell.identity, level = c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Meis2")), y = fraction, fill = species)) +
geom_bar(stat = "summary", fun = "median", position = position_dodge(width = 0.8), width = 0.75) +
geom_point(colour = "black", position = position_dodge(width = 0.8), size = 1) +
scale_x_discrete(labels = c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Meis2")) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75), expand = c(0, 0), limits = c(0, 0.751)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
theme_classic() + theme(axis.text = element_text(color = "black"), legend.text = element_text(size = 10)) +
labs(x = NULL, y = "Fraction of GABAergic Cells", fill = NULL) +
scale_fill_manual("legend", values = c("Opossum" = "#c692b8", "Mouse" = "#aaaaaa", "Human" = "#f1c296"))
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/HMO_GABAergic_Subclass_Proportion.svg", plot=hmo_gabaergic, width=4.5, height=3, dpi=500)
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/HMO_GABAergic_Subclass_Proportion.png", plot=hmo_gabaergic, width=4.5, height=3, dpi=500)
library(tidyverse)
library(dplyr)
mouse.counts <- read.csv("G:/Shared drives/Opossum transcriptomics/figures/Mouse_Subclass_Sample_v1.csv")
mouse.counts <- mouse.counts[-1, ]
rownames(mouse.counts) <- mouse.counts$X
mouse.counts <- mouse.counts[, -1]
mouse.counts$species <- "Mouse"
mouse.counts$GABAergic <- rowSums(mouse.counts[, c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Stac")])
opossum.counts <- read.csv("G:/Shared drives/Opossum transcriptomics/figures/Opossum_Subclass_Sample_V1.csv")
rownames(opossum.counts) <- opossum.counts$X
opossum.counts <- opossum.counts[, -1]
opossum.counts$species <- "Opossum"
opossum.counts$GABAergic <- rowSums(opossum.counts[, c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Stac")])
both.counts <- rbind(mouse.counts, opossum.counts)
both.counts$sample <- rownames(both.counts)
both.counts <- both.counts %>%
mutate(Pvalb = Pvalb / GABAergic,
Sst = Sst / GABAergic,
Vip = Vip / GABAergic,
Lamp5 = Lamp5 / GABAergic,
Frem1 = Frem1 / GABAergic,
Stac = Stac / GABAergic
)
scatter.counts <- both.counts
both.counts <- both.counts %>%
pivot_longer(
cols = c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Stac"),
names_to = "cell.identity",
values_to = "fraction"
)
both.counts$species <- factor(both.counts$species, levels = c("Opossum", "Mouse", "Human"))
class.counts <- both.counts[both.counts$cell.identity %in% c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Stac"), ]
ggplot(class.counts, aes(x = factor(cell.identity, level = c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Stac")), y = fraction, fill = species)) +
geom_bar(stat = "summary", fun = "median", position = position_dodge(width = 0.8), width = 0.75) +
geom_point(colour = "black", position = position_dodge(width = 0.8), size = 1) +
scale_x_discrete(labels = c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Stac")) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75), expand = c(0, 0), limits = c(0, 0.751)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
theme_classic() + theme(axis.text = element_text(color = "black"), legend.text = element_text(size = 10)) +
labs(x = NULL, y = "Fraction of GABAergic Cells", fill = NULL) +
scale_fill_manual("legend", values = c("Opossum" = "#c692b8", "Mouse" = "#aaaaaa", "Human" = "#f1c296"))
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/HMO_GABAergic_Subclass_Proportion.svg", plot=hmo_gabaergic, width=4.5, height=3, dpi=500)
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/HMO_GABAergic_Subclass_Proportion.png", plot=hmo_gabaergic, width=4.5, height=3, dpi=500)
mouse.counts
opossum.counts
library(tidyverse)
library(dplyr)
mouse.counts <- read.csv("G:/Shared drives/Opossum transcriptomics/figures/Mouse_Subclass_Sample_v1.csv")
rownames(mouse.counts) <- mouse.counts$X
mouse.counts <- mouse.counts[, -1]
mouse.counts$species <- "Mouse"
mouse.counts$GABAergic <- rowSums(mouse.counts[, c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Stac")])
opossum.counts <- read.csv("G:/Shared drives/Opossum transcriptomics/figures/Opossum_Subclass_Sample_V1.csv")
rownames(opossum.counts) <- opossum.counts$X
opossum.counts <- opossum.counts[, -1]
opossum.counts$species <- "Opossum"
opossum.counts$GABAergic <- rowSums(opossum.counts[, c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Stac")])
both.counts <- rbind(mouse.counts, opossum.counts)
both.counts$sample <- rownames(both.counts)
both.counts <- both.counts %>%
mutate(Pvalb = Pvalb / GABAergic,
Sst = Sst / GABAergic,
Vip = Vip / GABAergic,
Lamp5 = Lamp5 / GABAergic,
Frem1 = Frem1 / GABAergic,
Stac = Stac / GABAergic
)
scatter.counts <- both.counts
both.counts <- both.counts %>%
pivot_longer(
cols = c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Stac"),
names_to = "cell.identity",
values_to = "fraction"
)
both.counts$species <- factor(both.counts$species, levels = c("Opossum", "Mouse", "Human"))
class.counts <- both.counts[both.counts$cell.identity %in% c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Stac"), ]
ggplot(class.counts, aes(x = factor(cell.identity, level = c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Stac")), y = fraction, fill = species)) +
geom_bar(stat = "summary", fun = "median", position = position_dodge(width = 0.8), width = 0.75) +
geom_point(colour = "black", position = position_dodge(width = 0.8), size = 1) +
scale_x_discrete(labels = c("Pvalb", "Sst", "Vip", "Lamp5", "Frem1", "Stac")) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75), expand = c(0, 0), limits = c(0, 0.751)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
theme_classic() + theme(axis.text = element_text(color = "black"), legend.text = element_text(size = 10)) +
labs(x = NULL, y = "Fraction of GABAergic Cells", fill = NULL) +
scale_fill_manual("legend", values = c("Opossum" = "#c692b8", "Mouse" = "#aaaaaa", "Human" = "#f1c296"))
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/HMO_GABAergic_Subclass_Proportion.svg", plot=hmo_gabaergic, width=4.5, height=3, dpi=500)
# ggsave(file="G:/Shared drives/Opossum transcriptomics/figures/HMO_GABAergic_Subclass_Proportion.png", plot=hmo_gabaergic, width=4.5, height=3, dpi=500)
library(Seurat)
library(reticulate)
library(arrow)
library(ggplot2)
library(dplyr)
library(SeuratDisk)
obj.opossum.gabaergic <- LoadH5Seurat("E:/Opossum_V1/seurat/opossum_v1_gabaergic_raw.h5Seurat")
